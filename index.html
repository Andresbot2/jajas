<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script>
      AFRAME.registerComponent('limited-rotation', {
        schema: {
          minAngle: {type: 'number', default: -180},
          maxAngle: {type: 'number', default: 180},
          speed: {type: 'number', default: 20},
          axis: {type: 'string', default: 'y'}
        },
        
        init: function() {
          this.currentAngle = 0;
          this.direction = 1;
        },
        
        tick: function(time, timeDelta) {
          const data = this.data;
          const deltaSeconds = timeDelta / 1000;
          
          this.currentAngle += data.speed * deltaSeconds * this.direction;
          
          if (this.currentAngle >= data.maxAngle) {
            this.currentAngle = data.maxAngle;
            this.direction = -1;
          } else if (this.currentAngle <= data.minAngle) {
            this.currentAngle = data.minAngle;
            this.direction = 1;
          }
          
          const rotation = this.el.getAttribute('rotation');
          if (data.axis === 'y') {
            this.el.setAttribute('rotation', {x: rotation.x, y: this.currentAngle, z: rotation.z});
          } else if (data.axis === 'x') {
            this.el.setAttribute('rotation', {x: this.currentAngle, y: rotation.y, z: rotation.z});
          } else if (data.axis === 'z') {
            this.el.setAttribute('rotation', {x: rotation.x, y: rotation.y, z: this.currentAngle});
          }
        }
      });
    </script>
  </head>
  <body>
    <a-scene background="color: #2C3E50">
      
      <!-- Cámara con controles de movimiento WASD -->
      <a-entity id="rig" position="0 0 6">
        <a-entity 
          position="0 1.6 0" 
          camera 
          look-controls="pointerLockEnabled: true"
          wasd-controls="acceleration: 30">
        </a-entity>
      </a-entity>
      
      <!-- Iluminación industrial -->
      <a-entity light="type: directional; intensity: 0.8; castShadow: true" position="5 8 5"></a-entity>
      <a-entity light="type: directional; intensity: 0.6" position="-5 8 5"></a-entity>
      <a-entity light="type: ambient; intensity: 0.4; color: #9DB4C0"></a-entity>
      
      <!-- Luces puntuales superiores (estilo lámparas de fábrica) -->
      <a-entity light="type: point; intensity: 0.6; distance: 10" position="0 6 0"></a-entity>
      <a-entity light="type: point; intensity: 0.5; distance: 8" position="-4 6 -3"></a-entity>
      <a-entity light="type: point; intensity: 0.5; distance: 8" position="4 6 -3"></a-entity>
      
      <!-- Suelo industrial con textura -->
      <a-plane rotation="-90 0 0" width="30" height="30" 
               color="#34495E" 
               material="metalness: 0.3; roughness: 0.8"
               shadow="receive: true"></a-plane>
      
      <!-- Líneas del suelo -->
      <a-plane rotation="-90 0 0" width="30" height="0.1" position="0 0.01 -5" color="#F39C12"></a-plane>
      <a-plane rotation="-90 0 0" width="30" height="0.1" position="0 0.01 5" color="#F39C12"></a-plane>
      <a-plane rotation="-90 0 0" width="0.1" height="30" position="-5 0.01 0" color="#F39C12"></a-plane>
      <a-plane rotation="-90 0 0" width="0.1" height="30" position="5 0.01 0" color="#F39C12"></a-plane>
      
      <!-- Paredes de la fábrica -->
      <a-box position="0 3 -10" width="30" height="6" depth="0.3" 
             color="#3E5266" 
             material="metalness: 0.4; roughness: 0.7"></a-box>
      <a-box position="-10 3 0" width="0.3" height="6" depth="20" 
             color="#3E5266" 
             material="metalness: 0.4; roughness: 0.7"></a-box>
      <a-box position="10 3 0" width="0.3" height="6" depth="20" 
             color="#3E5266" 
             material="metalness: 0.4; roughness: 0.7"></a-box>
      
      <!-- Ventanas en la pared del fondo -->
      <a-box position="-4 4 -9.9" width="2" height="1.5" depth="0.2" color="#5DADE2" material="opacity: 0.3; transparent: true"></a-box>
      <a-box position="0 4 -9.9" width="2" height="1.5" depth="0.2" color="#5DADE2" material="opacity: 0.3; transparent: true"></a-box>
      <a-box position="4 4 -9.9" width="2" height="1.5" depth="0.2" color="#5DADE2" material="opacity: 0.3; transparent: true"></a-box>
      
      <!-- Vigas estructurales -->
      <a-box position="-8 5.5 0" width="0.3" height="1" depth="20" color="#95A5A6"></a-box>
      <a-box position="8 5.5 0" width="0.3" height="1" depth="20" color="#95A5A6"></a-box>
      <a-box position="0 5.5 -8" width="20" height="1" depth="0.3" color="#95A5A6"></a-box>
      
      <!-- Lámparas industriales colgantes -->
      <a-cylinder position="0 5 0" radius="0.5" height="0.3" color="#7F8C8D"></a-cylinder>
      <a-cylinder position="0 5.8 0" radius="0.05" height="1.5" color="#34495E"></a-cylinder>
      
      <a-cylinder position="-4 5 -3" radius="0.5" height="0.3" color="#7F8C8D"></a-cylinder>
      <a-cylinder position="-4 5.8 -3" radius="0.05" height="1.5" color="#34495E"></a-cylinder>
      
      <a-cylinder position="4 5 -3" radius="0.5" height="0.3" color="#7F8C8D"></a-cylinder>
      <a-cylinder position="4 5.8 -3" radius="0.05" height="1.5" color="#34495E"></a-cylinder>
      
      <!-- Mesa de trabajo / Banda transportadora con soporte -->
      <a-box position="0 0.25 0.8" 
             width="1.0" height="0.3" depth="0.6" 
             color="#555555"
             material="metalness: 0.5; roughness: 0.3"></a-box>
      
      <!-- Patas de la mesa -->
      <a-cylinder position="-0.4 0.05 0.5" radius="0.03" height="0.3" color="#444"></a-cylinder>
      <a-cylinder position="0.4 0.05 0.5" radius="0.03" height="0.3" color="#444"></a-cylinder>
      <a-cylinder position="-0.4 0.05 1.1" radius="0.03" height="0.3" color="#444"></a-cylinder>
      <a-cylinder position="0.4 0.05 1.1" radius="0.03" height="0.3" color="#444"></a-cylinder>
      
      <!-- Panel de control -->
      <a-box position="-2 1 0" width="0.5" height="1.2" depth="0.1" 
             color="#2C3E50"
             material="metalness: 0.6; roughness: 0.4"></a-box>
      <a-box position="-2 1.3 0.06" width="0.35" height="0.25" depth="0.05" 
             color="#27AE60"></a-box>
      <a-circle position="-2.1 0.8 0.06" radius="0.05" color="#E74C3C"></a-circle>
      <a-circle position="-1.95 0.8 0.06" radius="0.05" color="#F39C12"></a-circle>
      <a-circle position="-1.8 0.8 0.06" radius="0.05" color="#2ECC71"></a-circle>
      
      <!-- Estanterías industriales -->
      <a-box position="-8 1.5 -5" width="3" height="3" depth="1" 
             color="#566573"
             material="metalness: 0.3; roughness: 0.6"></a-box>
      <a-box position="-8 0.8 -5" width="2.8" height="0.05" depth="0.9" color="#7F8C8D"></a-box>
      <a-box position="-8 1.5 -5" width="2.8" height="0.05" depth="0.9" color="#7F8C8D"></a-box>
      <a-box position="-8 2.2 -5" width="2.8" height="0.05" depth="0.9" color="#7F8C8D"></a-box>
      
      <!-- Cajas en estantería -->
      <a-box position="-8.5 1 -5" width="0.3" height="0.3" depth="0.3" color="#E67E22"></a-box>
      <a-box position="-8 1 -5" width="0.3" height="0.3" depth="0.3" color="#3498DB"></a-box>
      <a-box position="-7.5 1 -5" width="0.3" height="0.3" depth="0.3" color="#9B59B6"></a-box>
      
      <!-- Contenedores industriales -->
      <a-box position="6 0.4 -6" width="1.2" height="0.8" depth="0.8" 
             color="#7F8C8D"
             material="metalness: 0.5; roughness: 0.5"></a-box>
      <a-box position="7.5 0.4 -6" width="1.2" height="0.8" depth="0.8" 
             color="#95A5A6"
             material="metalness: 0.5; roughness: 0.5"></a-box>
      
      <!-- Señalización de seguridad -->
      <a-plane position="-9.9 2 -3" width="1" height="1" rotation="0 90 0" 
               color="#F39C12"></a-plane>
      <a-text value="!" position="-9.85 2 -3" rotation="0 90 0" 
              align="center" color="#000" scale="3 3 3"></a-text>
      
      <!-- Extintores -->
      <a-cylinder position="-9.7 0.5 2" radius="0.1" height="0.8" color="#E74C3C"></a-cylinder>
      <a-cylinder position="9.7 0.5 2" radius="0.1" height="0.8" color="#E74C3C"></a-cylinder>
      
      <!-- Modelo del brazo GP12_AR1440 con rotación limitada -->
      <a-entity id="robot" 
                gltf-model="GP12_AR1440.glb" 
                scale="0.5 0.5 0.5"
                position="0 0 0.2"
                rotation="0 0 0"
                limited-rotation="minAngle: -45; maxAngle: 45; speed: 22.5; axis: y">
      </a-entity>
      
      <!-- Bloque móvil en proceso 1 -->
      <a-box id="moving-block-1"
             position="-0.5 0.6 0.8"
             width="0.15" height="0.2" depth="0.15"
             color="#FF6B6B"
             material="metalness: 0.3; transparent: true"
             animation="property: position; 
                        to: 0.5 0.6 0.8; 
                        from: -0.5 0.6 0.8;
                        dir: normal; 
                        loop: true; 
                        dur: 4000; 
                        easing: linear">
      </a-box>
      
      <!-- Bloque móvil en proceso 2 -->
      <a-box id="moving-block-2"
             position="-0.5 0.6 0.8"
             width="0.15" height="0.2" depth="0.15"
             color="#FF6B6B"
             material="metalness: 0.3; transparent: true"
             animation="property: position; 
                        to: 0.5 0.6 0.8; 
                        from: -0.5 0.6 0.8;
                        dir: normal; 
                        loop: true; 
                        dur: 4000;
                        delay: 2000; 
                        easing: linear">
      </a-box>
    </a-scene>
  </body>
</html>
